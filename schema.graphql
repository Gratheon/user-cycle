scalar JSON
scalar DateTime
scalar URL

input TranslationInput {
	key: String!
	context: String
	namespace: String
}

input RegisterInput {
	first_name: String
	last_name: String
	email: String!
	password: String!
	lang: String
	nonce: String!
	solution: String!
}

type Query {
	user: UserOrError
	invoices: [Invoice]
	apiTokens: [APIToken]
	shareTokens: [ShareToken]
	translate(en: String, key: String, tc: String): Locale
	translateBatch(requests: [TranslateRequest!]!): [Locale]
	getTranslations(inputs: [TranslationInput!]!): [Translation]
	getPluralRules(lang: String!): PluralRules
	validateShareToken(token: String!): ValidateShareTokenResult
	registrationNonce: RegistrationNonce
}

type APIToken {
	id: ID!
	token: String!
}
type ShareToken {
	id: ID!
	token: String!

	name: String
	scopes: JSON
	targetUrl: URL
}

type ShareTokenDetails {
	id: ID!
	name: String
	scopes: JSON
	userId: ID! # Add the user ID field
}

type Invoice {
	id: ID!
	total: Float
	currency: String
	date: DateTime
	url: URL
}

type Locale {
	id: ID!
	en: String!
	ru: String
	et: String
	tr: String
	pl: String
	de: String
	fr: String
	key: String
}

type Translation {
	id: ID!
	key: String!
	namespace: String
	context: String
	values: JSON
	plurals: JSON
	isPlural: Boolean!
}

type PluralRules {
	lang: String!
	forms: [String!]!
}

type RegistrationNonce {
	nonce: String!
	challenge: String!
	difficulty: Int!
}

type Mutation {
	register(input: RegisterInput!): LoginResult
	login(email: String!, password: String!): LoginResult
	generateApiToken: APIToken
	generateShareToken(name: String!, scopes: JSON!, sourceUrl: URL!, scopeParams: JSON!): ShareToken
	validateApiToken(token: String): ValidateTokenResult
	updateUser(user: UserUpdateInput!): UpdateUserResult
	createCheckoutSession: URL
	cancelSubscription: CancelSubscriptionResult
	deleteUserSelf: Error

	revokeApiToken(token: String!): Error
	revokeShareToken(token: String!): Error

	updateTranslationValue(key: String!, lang: String!, value: String!, namespace: String): Translation
	batchTranslateLanguage(langCode: String!): BatchTranslationResult
}

type BatchTranslationProgress {
	total: Int!
	processed: Int!
	skipped: Int!
	errors: Int!
	currentKey: String
	isComplete: Boolean!
}

type BatchTranslationResult {
	success: Boolean!
	total: Int!
	processed: Int!
	skipped: Int!
	errors: Int!
	message: String
}

type TokenUser {
	id: ID!
}

type UserSession {
	key: String
	user: User
}

type Error{
	code: String
}

union UserOrError = User | Error
union ValidateTokenResult = TokenUser | Error
union ValidateShareTokenResult = ShareTokenDetails | Error
union LoginResult = UserSession | Error
union UpdateUserResult = User | Error
union CancelSubscriptionResult = User | Error

type User {
	id: ID!
	email: String
	first_name: String
	last_name: String

	"""
	Language code: en, ru, tr, et, pl
	"""
	lang: String
	date_added: DateTime
	date_expiration: DateTime
	hasSubscription: Boolean
	isSubscriptionExpired: Boolean


	"""
	Billing plan: free, base, pro
	"""
	billingPlan: String
}

input UserUpdateInput{
	first_name: String
	last_name: String
	lang: String
}

input TranslateRequest {
	en: String!
	tc: String
	key: String
}
